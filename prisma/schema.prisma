// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// Plants
model plants {
  id             Int              @id @default(autoincrement())
  name           String
  description    String?
  collection     plant_collection
  origin         origin_plant     @default(Indefinido)
  purchase_price Float            @default(0.0)
  status         status_plant     @default(Em_Posse)
  created_at     DateTime         @default(now())

  stock       stock_plants[]
  purchase    purchases[]
  propagation propagation[]  @relation("plant_relation")
  mother      propagation[]  @relation("mother_relation")
}

model propagation {
  plant_id        Int      @id
  mother_plant_id Int
  obs             String?
  created_at      DateTime @default(now())

  plant        plants @relation("plant_relation", fields: [plant_id], references: [id])
  mother_plant plants @relation("mother_relation", fields: [mother_plant_id], references: [id])
}

model stock_plants {
  plant_id              Int      @id
  recommended_min_price Float?
  recommended_max_price Float?
  created_at            DateTime @default(now())

  plant plants @relation(fields: [plant_id], references: [id])
}

enum plant_collection {
  Pessoal
  Loja
}

enum status_plant {
  Em_Posse
  A_venda
  Reservado
  Vendida
}

enum origin_plant {
  Compra
  Propagacao
  Indefinido
}

// Cachepots
model cachepots {
  id            Int      @id @default(autoincrement())
  color         String
  size          String
  description   String
  purchasePrice Float
  created_at    DateTime @default(now())

  stock_cachepots stock_cachepots[]
  purchase        purchases[]
}

model stock_cachepots {
  cachepot_id    Int                   @id
  status         status_stock_cachepot @default(A_venda)
  origin         origin_stock_cachepot
  estimatedValue Float
  created_at     DateTime              @default(now())

  cachepot cachepots @relation(fields: [cachepot_id], references: [id])
}

enum origin_stock_cachepot {
  Compra
  Propagacao
}

enum status_stock_cachepot {
  A_venda
  Reservado
  Vendida
}

// Compras
model purchases {
  id           Int             @id @default(autoincrement())
  plant_ids    Int?
  cachepot_ids Int?
  place        String
  description  String?
  obs          String?
  value        Float
  reason       reason_purchase
  created_at   DateTime        @default(now())

  plants    plants[]    @relation(fields: [plant_ids], references: [id])
  cachepots cachepots[] @relation(fields: [cachepot_ids], references: [id])
}

enum reason_purchase {
  Estoque
  Ferramentas
  Investimento
}
